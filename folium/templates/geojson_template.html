<!DOCTYPE html>
<head>
   <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.5/leaflet.css" />
   <!--[if lte IE 8]>
       <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.5/leaflet.ie.css" />
   <![endif]-->
   <script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>

<style>

#map {
  position:absolute;
  top:0;
  bottom:0;
  right:0;
  left:0;
}

</style>
</head>
<body>

        <div id="map" {{ size }}></div>

        <script src="http://cdn.leafletjs.com/leaflet-0.5/leaflet.js"></script>

<script>

d3.json('{{ geo_json }}', function(error, json) {

    mapdata = json;

    var map = L.map('map').setView([{{ lat }}, {{ lon }}], {{ zoom_level }});

    L.tileLayer('{{ Tiles }}', {
        maxZoom: {{ max_zoom }},
        attribution: '{{ attr }}'
    }).addTo(map);

    {% for mark, popup in markers %}
    {{ mark }}
    {{ popup }}
    {% endfor %}

    {{ lat_lng_pop }}

    {{ click_pop }}

    {{ geo_style }}

    gJson_layer = L.geoJson(mapdata, {style: style}).addTo(map);

});

</script>

</body>
